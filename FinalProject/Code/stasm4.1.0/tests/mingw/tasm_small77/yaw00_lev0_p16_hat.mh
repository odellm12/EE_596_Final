// yaw00_lev0_p16_hat.mh: machine generated HAT descriptor matcher
//
// Command: tasm -d test_tasmout -w ../tasm/shapes/muct77_short.shape

#ifndef STASM_YAW00_LEV0_P16_HAT_MH
#define STASM_YAW00_LEV0_P16_HAT_MH

namespace stasm {

// static const int EYEMOUTH_DIST = 100;
// static const double PYR_RATIO = 2;

static double linmod(
    const double* const x,
    const double        intercept,
    const double* const coef,
    const int           n)
{
    double yhat = intercept;
#if 0                               // unoptimized
    for (int i = 0; i < n; i++)
        yhat += coef[i] * x[i];
#else                               // optimized
    const int n4 = n - 4;
    int i = 0;
    if (n4 > 0)
    {
        for (; i < n4; i += 4)
            yhat += coef[i]   * x[i]   +
                    coef[i+1] * x[i+1] +
                    coef[i+2] * x[i+2] +
                    coef[i+3] * x[i+3];
    }
    for (; i < n; i++)
        yhat += coef[i] * x[i];
#endif
    return yhat;
}

static double yaw00_lev0_p16_hatfit(const double* const d) // d has 160 elements
{
const double intercept = 0.0275084;

static const double coef[160] = // linear regression coefficients
{
    1.07488, -0.215568, 0.0816585, -0.29747, -0.179654, -0.835994, -0.254442, 0.417091, 0.551305, -0.583805, 0.0675439,
    0.420001, -0.175151, -0.1808, 0.467126, 0.853732, -0.760619, -0.012279, 0.2418, 0.0841268, 0.122096, 0.431087,
    0.575696, 0.1249, 0.327446, 0.143549, -0.192418, -0.131623, 0.451887, -0.201719, -0.0272095, 0.476006, 0.62075,
    0.542059, -0.285487, -0.0982202, 0.347697, -0.430215, 0.431406, 1.04532, -0.11328, 0.0495162, 0.174075, 0.570162,
    0.324517, -0.114147, -0.0422776, -0.225754, -0.0377297, 0.195236, 0.0855767, -0.0268182, -0.456328, 0.469023, 0.125612,
    -0.33543, -0.273677, -0.246043, 0.0440633, 0.279588, 0.072161, -0.324643, -0.416287, 0.531351, 0.408213, -0.141901,
    0.072362, 0.0624803, 0.225418, 0.65505, -0.723204, 0.247657, 0.190212, -0.421072, -0.279868, -0.189278, -0.155876,
    -0.0917283, -0.157942, 0.321356, -0.319786, -0.147562, 0.27586, 0.98407, 0.0825489, -0.0119767, 0.572472, -0.466053,
    0.419765, 0.0348451, 0.115318, 0.41005, -0.234003, 0.450733, -0.04696, -0.468805, 0.689339, 0.144664, -0.349863,
    0.0126825, 0.222884, 0.519126, -0.436237, 0.314856, 0.503341, -0.706016, -0.333386, 0.25674, 0.342067, 0.522853,
    -0.0358417, -0.0698454, -1.09213, -0.00759026, 0.253366, -0.249081, -0.0294662, -0.00184723, 0.970533, -1.15934, 0.791794,
    -0.0406922, -0.422235, 0.403793, -0.0794, -0.0413862, -0.40903, 1.27815, -0.0508125, -0.32602, -0.698419, 0.702486,
    0.604436, 0.411886, -0.59995, 0.462922, 0.726924, -0.0389387, -0.195577, -0.255731, 0.213597, 0.476268, 0.273046,
    -0.0692357, 0.0749457, -0.334139, -0.620892, 0.318066, 0.326604, 0.514174, -0.00786323, -0.336901, -0.375058, -0.0757215,
    0.608304, -0.137978, 0.19591, 0.177372, 0.331759, 0.212599
};
// negative below because lowest distance is best fit
return -linmod(d, intercept, coef, 160);
}

static const HatDescMod yaw00_lev0_p16_hat(yaw00_lev0_p16_hatfit);

} // namespace stasm
#endif // STASM_YAW00_LEV0_P16_HAT_MH
